import{j as e,b as rn,u as B,c as M}from"./vendor-query-Bq4hz6H9.js";import{r as l,u as on}from"./vendor-router-CdtyvhQv.js";import{u as ln,b as cn,a as _,g as w}from"./index-BN0IhMzD.js";import{M as I,a2 as dn,B as T,e as ke,f as G,g as p,P as we,b as x,h as r,l as W,L as j,C as y,a,$ as g,z as S,T as s,c as b,v as We,R as un,w as hn,t as P,V as u,a3 as pn,k as mn,a1 as ge,I as Ce,a4 as gn,a5 as bn,S as xn}from"./vendor-polaris-psd3hcVR.js";import{u as jn,S as yn}from"./vendor-appbridge-DL6abzKC.js";import"./vendor-react-N--QU9DW.js";import"./vendor-sentry-UzNpYtBG.js";const fn=[{label:"Bug Report",value:"bug"},{label:"Feature Request",value:"feature_request"},{label:"Question",value:"question"},{label:"Other",value:"other"}],Sn=[{label:"Low - Minor issue, workaround available",value:"low"},{label:"Medium - Affects workflow but manageable",value:"medium"},{label:"High - Significant impact on operations",value:"high"},{label:"Critical - Cannot use the app",value:"critical"}];function vn({open:t,onClose:i}){const{showSuccess:h,showError:v}=ln(),[k,R]=l.useState(""),[$,ne]=l.useState(""),[D,z]=l.useState("bug"),[K,se]=l.useState("medium"),[J,V]=l.useState(""),[be,te]=l.useState(!1),[A,H]=l.useState(!1),[xe,ae]=l.useState(""),E=l.useCallback(()=>{R(""),ne(""),z("bug"),se("medium"),V(""),H(!1),ae("")},[]),L=l.useCallback(()=>{E(),i()},[i,E]),je=l.useCallback(async()=>{if(!k.trim()){v("Please enter a title");return}if(!$.trim()){v("Please enter a description");return}te(!0);try{const F={userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,screenSize:`${window.screen.width}x${window.screen.height}`,viewportSize:`${window.innerWidth}x${window.innerHeight}`,url:window.location.href,timestamp:new Date().toISOString()},O=await cn.post("/settings/bug-report",{title:k.trim(),description:$.trim(),category:D,severity:K,steps_to_reproduce:J.trim(),browser_info:F});O.data.success?(ae(O.data.report_id),H(!0),h("Bug report submitted successfully!")):v(O.data.error||"Failed to submit report")}catch(F){console.error("Error submitting bug report:",F),v("Failed to submit bug report. Please try again.")}finally{te(!1)}},[k,$,D,K,J,h,v]),ie=()=>e.jsxs(ke,{children:[e.jsx(G,{label:"Category",options:fn,value:D,onChange:z}),e.jsx(p,{label:"Title",value:k,onChange:R,placeholder:"Brief description of the issue",autoComplete:"off",maxLength:200}),e.jsx(p,{label:"Description",value:$,onChange:ne,multiline:4,placeholder:"Please describe the issue in detail...",autoComplete:"off",maxLength:2e3}),D==="bug"&&e.jsxs(e.Fragment,{children:[e.jsx(G,{label:"Severity",options:Sn,value:K,onChange:se,helpText:"How significantly does this affect your workflow?"}),e.jsx(p,{label:"Steps to Reproduce (Optional)",value:J,onChange:V,multiline:3,placeholder:`1. Go to...
2. Click on...
3. Observe...`,autoComplete:"off",maxLength:1e3})]})]}),re=()=>e.jsxs(dn,{children:[e.jsx(T,{tone:"success",children:e.jsx("p",{children:"Thank you for your feedback!"})}),e.jsxs("p",{style:{marginTop:"16px"},children:["Your report has been submitted with reference ID: ",e.jsx("strong",{children:xe})]}),e.jsxs("p",{style:{marginTop:"8px"},children:["Our team will review your submission and get back to you if needed. You can contact us at"," ",e.jsx("a",{href:"mailto:mike@orbsportscards.com",children:"mike@orbsportscards.com"})," ","if you have any urgent issues."]})]});return e.jsx(I,{open:t,onClose:L,title:A?"Report Submitted":"Submit Feedback",primaryAction:A?{content:"Close",onAction:L}:{content:"Submit Report",onAction:je,loading:be,disabled:!k.trim()||!$.trim()},secondaryActions:A?[{content:"Submit Another",onAction:E}]:[{content:"Cancel",onAction:L}],children:e.jsx(I.Section,{children:A?re():ie()})})}async function _n(t){const i=await _(`${w()}/settings`,t);if(!i.ok)throw new Error("Failed to fetch settings");return i.json()}async function wn(t,i,h){const v=i.replace(/_/g,"-"),k=i==="root"?"":`/${v}`,R=await _(`${w()}/settings${k}`,t,{method:"PATCH",body:JSON.stringify(h)});if(!R.ok)throw new Error("Failed to update settings");return R.json()}async function Cn(t){const i=await _(`${w()}/settings/segments`,t);if(!i.ok)throw new Error("Failed to fetch segments");return i.json()}async function kn(t){const i=await _(`${w()}/settings/segments/sync`,t,{method:"POST"});if(!i.ok)throw new Error("Failed to sync segments");return i.json()}async function Tn(t){const i=await _(`${w()}/settings/products`,t);if(!i.ok)throw new Error("Failed to fetch products");return i.json()}async function An(t){const i=await _(`${w()}/settings/products/sync`,t,{method:"POST"});if(!i.ok)throw new Error("Failed to sync products");return i.json()}const En=[{label:"Never expires",value:""},{label:"30 days",value:"30"},{label:"60 days",value:"60"},{label:"90 days",value:"90"},{label:"180 days",value:"180"},{label:"1 year (365 days)",value:"365"}];async function Pn(t){const i=await _(`${w()}/email/templates`,t);if(!i.ok)throw new Error("Failed to fetch templates");return i.json()}async function Fn(t,i){const h=await _(`${w()}/email/preview`,t,{method:"POST",body:JSON.stringify({template_id:i})});if(!h.ok)throw new Error("Failed to preview template");return h.json()}async function Mn(t,i,h,v){const k=await _(`${w()}/email/send-test`,t,{method:"POST",body:JSON.stringify({template_id:i,to_email:h,to_name:v})});if(!k.ok)throw new Error("Failed to send test email");return k.json()}async function In(t){const i=await _(`${w()}/members/tiers`,t);if(!i.ok)throw new Error("Failed to fetch tiers");return i.json()}async function Rn(t,i){const h=await _(`${w()}/members/tiers`,t,{method:"POST",body:JSON.stringify(i)});if(!h.ok)throw new Error("Failed to create tier");return h.json()}async function $n(t,i,h){const v=await _(`${w()}/members/tiers/${i}`,t,{method:"PUT",body:JSON.stringify(h)});if(!v.ok)throw new Error("Failed to update tier");return v.json()}async function Dn(t,i){const h=await _(`${w()}/members/tiers/${i}`,t,{method:"DELETE"});if(!h.ok){const v=await h.json();throw new Error(v.error||"Failed to delete tier")}}async function Un(t){const i=await _(`${w()}/scheduled-tasks/monthly-credits/preview`,t);if(!i.ok)throw new Error("Failed to fetch preview");return i.json()}async function qn(t){const i=await _(`${w()}/scheduled-tasks/monthly-credits/run`,t,{method:"POST"});if(!i.ok)throw new Error("Failed to run monthly credits");return i.json()}async function Ln(t,i=7){const h=await _(`${w()}/scheduled-tasks/expiration/upcoming?days=${i}`,t);if(!h.ok)throw new Error("Failed to fetch expiring credits");return h.json()}async function On(t){const i=await _(`${w()}/scheduled-tasks/expiration/run`,t,{method:"POST"});if(!i.ok)throw new Error("Failed to run expiration");return i.json()}function Qn({shop:t}){const i=on(),h=rn(),[v,k]=l.useState(!1),[R,$]=l.useState({}),[ne,D]=l.useState(!1),z=jn(),{data:K,isLoading:se,error:J}=B({queryKey:["settings",t],queryFn:()=>_n(t),enabled:!!t}),{data:V,isLoading:be,refetch:te}=B({queryKey:["segments",t],queryFn:()=>Cn(t),enabled:!!t}),A=M({mutationFn:()=>kn(t),onSuccess:()=>{h.invalidateQueries({queryKey:["segments"]})}}),{data:H,isLoading:xe,refetch:ae}=B({queryKey:["membership-products",t],queryFn:()=>Tn(t),enabled:!!t}),E=M({mutationFn:()=>An(t),onSuccess:()=>{h.invalidateQueries({queryKey:["membership-products"]})}}),{data:L,isLoading:je}=B({queryKey:["tiers",t],queryFn:()=>In(t),enabled:!!t}),[ie,re]=l.useState(!1),[F,O]=l.useState(null),[oe,le]=l.useState(null),[o,C]=l.useState({name:"",monthly_price:"9.99",yearly_price:"",bonus_rate:"0.05",discount_percent:"0",purchase_cashback_pct:"0",monthly_credit:"0",credit_expiration_days:"",free_shipping:!1,priority_support:!1,early_access:!1,exclusive_events:!1,signup_bonus:"0"}),[ce,U]=l.useState(""),de=l.useCallback(n=>{n?(O(n),C({name:n.name,monthly_price:String(n.monthly_price),yearly_price:n.yearly_price?String(n.yearly_price):"",bonus_rate:String((n.bonus_rate||0)*100),discount_percent:String(n.benefits?.discount_percent||0),purchase_cashback_pct:String(n.purchase_cashback_pct||0),monthly_credit:String(n.monthly_credit_amount||0),credit_expiration_days:n.credit_expiration_days?String(n.credit_expiration_days):"",free_shipping:n.benefits?.free_shipping||!1,priority_support:n.benefits?.priority_support||!1,early_access:n.benefits?.early_access||!1,exclusive_events:n.benefits?.exclusive_events||!1,signup_bonus:String(n.benefits?.signup_bonus||0)})):(O(null),C({name:"",monthly_price:"9.99",yearly_price:"",bonus_rate:"5",discount_percent:"0",purchase_cashback_pct:"0",monthly_credit:"0",credit_expiration_days:"",free_shipping:!1,priority_support:!1,early_access:!1,exclusive_events:!1,signup_bonus:"0"})),U(""),re(!0)},[]),ue=l.useCallback(()=>{re(!1),O(null),U("")},[]),ye=M({mutationFn:n=>Rn(t,n),onSuccess:()=>{h.invalidateQueries({queryKey:["tiers"]}),ue()},onError:n=>U(n.message)}),fe=M({mutationFn:({id:n,data:m})=>$n(t,n,m),onSuccess:()=>{h.invalidateQueries({queryKey:["tiers"]}),ue()},onError:n=>U(n.message)}),Te=M({mutationFn:n=>Dn(t,n),onSuccess:()=>{h.invalidateQueries({queryKey:["tiers"]})},onError:n=>U(n.message)}),[Ae,N]=l.useState(""),[Ee,X]=l.useState(""),{data:q,isLoading:Pe,refetch:Ge}=B({queryKey:["monthly-credits-preview",t],queryFn:()=>Un(t),enabled:!!t}),{data:Q,isLoading:Fe,refetch:ze}=B({queryKey:["expiring-credits",t],queryFn:()=>Ln(t,7),enabled:!!t}),Me=M({mutationFn:()=>qn(t),onSuccess:n=>{N(n.message),X(""),h.invalidateQueries({queryKey:["monthly-credits-preview"]}),setTimeout(()=>N(""),5e3)},onError:n=>{X(n.message),N("")}}),Ie=M({mutationFn:()=>On(t),onSuccess:n=>{N(n.message),X(""),h.invalidateQueries({queryKey:["expiring-credits"]}),setTimeout(()=>N(""),5e3)},onError:n=>{X(n.message),N("")}}),{data:Re,isLoading:Ke}=B({queryKey:["email-templates",t],queryFn:()=>Pn(t),enabled:!!t}),[Ve,Se]=l.useState(!1),[He,he]=l.useState(!1),[Z,$e]=l.useState(null),[Qe,Ye]=l.useState(""),[Je,Xe]=l.useState(""),[pe,De]=l.useState(""),[Ue,qe]=l.useState(""),[Le,ve]=l.useState(""),[Oe,Y]=l.useState(""),[Ze,Ne]=l.useState(!1),_e=M({mutationFn:n=>Fn(t,n),onSuccess:n=>{Ye(n.html_body),Xe(n.subject),Se(!0)}}),Be=M({mutationFn:()=>{if(!Z)throw new Error("No template selected");return Mn(t,Z.id,pe,Ue)},onSuccess:n=>{n.success?(ve(`Test email sent to ${pe}`),he(!1),De(""),qe(""),setTimeout(()=>ve(""),5e3)):Y(n.error||"Failed to send test email")},onError:n=>Y(n.message)}),en=l.useCallback(n=>{$e(n),_e.mutate(n.id)},[_e]),nn=l.useCallback(n=>{$e(n),Y(""),he(!0)},[]),sn=l.useCallback(()=>{if(!o.name.trim()){U("Tier name is required");return}const n={name:o.name.trim(),monthly_price:parseFloat(o.monthly_price)||0,yearly_price:o.yearly_price?parseFloat(o.yearly_price):void 0,bonus_rate:(parseFloat(o.bonus_rate)||0)/100,purchase_cashback_pct:parseFloat(o.purchase_cashback_pct)||0,monthly_credit_amount:parseFloat(o.monthly_credit)||0,credit_expiration_days:o.credit_expiration_days?parseInt(o.credit_expiration_days):null,benefits:{discount_percent:parseFloat(o.discount_percent)||0,free_shipping:o.free_shipping,priority_support:o.priority_support,early_access:o.early_access,exclusive_events:o.exclusive_events,signup_bonus:parseFloat(o.signup_bonus)||0}};F?fe.mutate({id:F.id,data:n}):ye.mutate(n)},[o,F,ye,fe]),me=M({mutationFn:async()=>{for(const[n,m]of Object.entries(R))Object.keys(m).length>0&&await wn(t,n,m)},onSuccess:()=>{h.invalidateQueries({queryKey:["settings"]}),k(!1),$({}),D(!0),setTimeout(()=>D(!1),3e3)}}),d=l.useCallback((n,m,f)=>{$(ee=>({...ee,[n]:{...ee[n]||{},[m]:f}})),k(!0)},[]),tn=l.useCallback(()=>{me.mutate()},[me]),an=l.useCallback(()=>{$({}),k(!1)},[]);l.useEffect(()=>{v?z.saveBar.show("settings-save-bar"):z.saveBar.hide("settings-save-bar")},[v,z.saveBar]);const c=l.useCallback((n,m,f)=>{const ee=R[n]?.[m];return ee!==void 0?ee:K?.settings?.[n]?.[m]??f},[K,R]);return t?se?e.jsx(we,{title:"Settings",children:e.jsx(x,{padding:"1600",children:e.jsx(r,{align:"center",children:e.jsx(W,{size:"large"})})})}):e.jsxs(we,{title:"Settings",subtitle:"Configure your TradeUp loyalty program",children:[ne&&e.jsx(x,{paddingBlockEnd:"400",children:e.jsx(T,{tone:"success",onDismiss:()=>D(!1),children:e.jsx("p",{children:"Settings saved successfully."})})}),e.jsxs(j,{children:[J&&e.jsx(j.Section,{children:e.jsx(T,{tone:"critical",children:e.jsx("p",{children:"Failed to load settings. Please try refreshing the page."})})}),e.jsx(j.AnnotatedSection,{id:"branding",title:"Branding",description:"Customize your program's appearance",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(p,{label:"Program Name",value:c("branding","app_name","TradeUp"),onChange:n=>d("branding","app_name",n),helpText:"Shown to customers in their membership dashboard",autoComplete:"off"}),e.jsx(p,{label:"Tagline",value:c("branding","tagline",""),onChange:n=>d("branding","tagline",n),helpText:"A short description of your loyalty program",autoComplete:"off"}),e.jsx(G,{label:"Style",options:[{label:"Glass (Modern)",value:"glass"},{label:"Solid",value:"solid"},{label:"Minimal",value:"minimal"}],value:c("branding","style","glass"),onChange:n=>d("branding","style",n)})]})})}),e.jsx(j.AnnotatedSection,{id:"general",title:"General",description:"Basic program configuration",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(G,{label:"Currency",options:[{label:"USD ($)",value:"USD"},{label:"CAD (C$)",value:"CAD"},{label:"EUR (€)",value:"EUR"},{label:"GBP (£)",value:"GBP"},{label:"AUD (A$)",value:"AUD"}],value:c("general","currency","USD"),onChange:n=>d("general","currency",n)}),e.jsx(G,{label:"Timezone",options:[{label:"Pacific Time (US)",value:"America/Los_Angeles"},{label:"Mountain Time (US)",value:"America/Denver"},{label:"Central Time (US)",value:"America/Chicago"},{label:"Eastern Time (US)",value:"America/New_York"},{label:"UTC",value:"UTC"},{label:"London (GMT)",value:"Europe/London"}],value:c("general","timezone","America/Los_Angeles"),onChange:n=>d("general","timezone",n)})]})})}),e.jsx(j.AnnotatedSection,{id:"features",title:"Features",description:"Enable or disable program features",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(g,{label:"Enable self-signup",checked:c("features","self_signup_enabled",!0),onChange:n=>d("features","self_signup_enabled",n),helpText:"Allow customers to sign up for membership themselves"}),e.jsx(g,{label:"Enable points system",checked:c("features","points_enabled",!1),onChange:n=>d("features","points_enabled",n),helpText:"Award points for purchases that can be redeemed for rewards"}),e.jsx(g,{label:"Enable referral program",checked:c("features","referrals_enabled",!1),onChange:n=>d("features","referrals_enabled",n),helpText:"Allow members to earn rewards by referring new customers"}),e.jsx(S,{}),e.jsx(g,{label:"Show advanced features",checked:c("features","advanced_features_enabled",!1),onChange:n=>d("features","advanced_features_enabled",n),helpText:"Shows Promotions, Points & Rewards, and Membership Tiers in the navigation sidebar. Perfect for power users."})]})})}),!c("features","advanced_features_enabled",!1)&&e.jsx(j.AnnotatedSection,{id:"tiers-shortcut",title:"Membership Tiers",description:"Configure your membership tiers and benefits",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(s,{as:"p",variant:"bodyMd",children:"Set up tier pricing, trade-in bonuses, and member benefits for your loyalty program."}),e.jsx(b,{url:"/app/tiers",fullWidth:!0,children:"Manage Membership Tiers"})]})})}),e.jsx(j.AnnotatedSection,{id:"auto-enrollment",title:"Auto-Enrollment",description:"Automatically enroll customers on first purchase",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(g,{label:"Enable auto-enrollment",checked:c("auto_enrollment","enabled",!0),onChange:n=>d("auto_enrollment","enabled",n),helpText:"Automatically enroll customers when they make their first purchase"}),e.jsx(p,{label:"Minimum Order Value",type:"number",value:String(c("auto_enrollment","min_order_value",0)),onChange:n=>d("auto_enrollment","min_order_value",parseFloat(n)||0),prefix:"$",helpText:"Only auto-enroll if order is at least this amount (0 = any order)",autoComplete:"off"})]})})}),e.jsx(j.AnnotatedSection,{id:"cashback",title:"Cashback & Rewards",description:"Configure how rewards are delivered",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(G,{label:"Reward Delivery Method",options:[{label:"Shopify Native Store Credit (Recommended)",value:"native_store_credit"},{label:"Unique Discount Codes",value:"discount_code"},{label:"Shopify Gift Cards",value:"gift_card"},{label:"Manual Fulfillment",value:"manual"}],value:c("cashback","method","native_store_credit"),onChange:n=>d("cashback","method",n),helpText:"How store credit and rewards are delivered to customers"}),e.jsx(S,{}),e.jsx(g,{label:"Enable purchase cashback",checked:c("cashback","purchase_cashback_enabled",!0),onChange:n=>d("cashback","purchase_cashback_enabled",n),helpText:"Award cashback percentage on purchases based on tier"}),e.jsx(g,{label:"Enable trade-in credit",checked:c("cashback","trade_in_credit_enabled",!0),onChange:n=>d("cashback","trade_in_credit_enabled",n),helpText:"Award bonus credit on trade-ins based on tier"}),e.jsx(g,{label:"Same-transaction bonus",checked:c("cashback","same_transaction_bonus",!0),onChange:n=>d("cashback","same_transaction_bonus",n),helpText:"Apply tier benefits to the order that includes membership purchase"})]})})}),e.jsx(j.AnnotatedSection,{id:"trade-ins",title:"Trade-In Rules",description:"Configure automatic approval thresholds",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(g,{label:"Enable trade-ins",checked:c("trade_ins","enabled",!0),onChange:n=>d("trade_ins","enabled",n)}),e.jsx(g,{label:"Allow guest trade-ins",checked:c("trade_ins","allow_guest_trade_ins",!0),onChange:n=>d("trade_ins","allow_guest_trade_ins",n),helpText:"Allow non-members to submit trade-ins (no tier bonus)"}),e.jsx(S,{}),e.jsx(p,{label:"Auto-Approve Under",type:"number",value:String(c("trade_ins","auto_approve_under",50)),onChange:n=>d("trade_ins","auto_approve_under",parseFloat(n)||0),prefix:"$",helpText:"Trade-ins under this amount will be automatically approved",autoComplete:"off"}),e.jsx(p,{label:"Require Review Over",type:"number",value:String(c("trade_ins","require_review_over",500)),onChange:n=>d("trade_ins","require_review_over",parseFloat(n)||0),prefix:"$",helpText:"Trade-ins over this amount will require manual review",autoComplete:"off"}),e.jsx(g,{label:"Require photo uploads",checked:c("trade_ins","require_photos",!1),onChange:n=>d("trade_ins","require_photos",n),helpText:"Customers must upload photos when submitting trade-ins"})]})})}),e.jsx(j.AnnotatedSection,{id:"subscriptions",title:"Subscriptions",description:"Membership subscription options",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsxs(a,{gap:"200",children:[e.jsx(g,{label:"Enable monthly subscriptions",checked:c("subscriptions","monthly_enabled",!0),onChange:n=>d("subscriptions","monthly_enabled",n)}),e.jsx(g,{label:"Enable yearly subscriptions",checked:c("subscriptions","yearly_enabled",!0),onChange:n=>d("subscriptions","yearly_enabled",n)})]}),e.jsx(p,{label:"Free Trial Days",type:"number",value:String(c("subscriptions","trial_days",0)),onChange:n=>d("subscriptions","trial_days",parseInt(n)||0),suffix:"days",helpText:"Number of free trial days (0 = no trial)",autoComplete:"off"}),e.jsx(p,{label:"Grace Period",type:"number",value:String(c("subscriptions","grace_period_days",3)),onChange:n=>d("subscriptions","grace_period_days",parseInt(n)||0),suffix:"days",helpText:"Days to retry failed payments before downgrading tier",autoComplete:"off"})]})})}),c("features","advanced_features_enabled",!1)&&e.jsx(j.AnnotatedSection,{id:"tiers",title:"Membership Tiers",description:"Configure tier benefits and pricing",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Your Tiers"}),e.jsx(b,{onClick:()=>de(),icon:We,children:"Add Tier"})]}),ce&&!ie&&e.jsx(T,{tone:"critical",onDismiss:()=>U(""),children:e.jsx("p",{children:ce})}),je?e.jsxs(r,{align:"center",children:[e.jsx(W,{size:"small"}),e.jsx(s,{as:"span",variant:"bodySm",tone:"subdued",children:"Loading tiers..."})]}):L?.tiers&&L.tiers.length>0?e.jsx(un,{resourceName:{singular:"tier",plural:"tiers"},items:L.tiers.filter(n=>n&&n.id!=null),renderItem:n=>e.jsx(hn,{id:String(n.id),onClick:()=>de(n),shortcutActions:[{content:"Edit",onAction:()=>de(n)},{content:"Delete",onAction:()=>le(n)}],children:e.jsx(r,{align:"space-between",blockAlign:"center",children:e.jsxs(a,{gap:"100",children:[e.jsxs(r,{gap:"200",blockAlign:"center",children:[e.jsx(s,{as:"h4",variant:"bodyMd",fontWeight:"semibold",children:n.name}),n.is_active?e.jsx(P,{tone:"success",children:"Active"}):e.jsx(P,{children:"Inactive"})]}),e.jsxs(r,{gap:"300",children:[e.jsxs(s,{as:"span",variant:"bodySm",tone:"subdued",children:["$",n.monthly_price,"/mo",n.yearly_price?` · $${n.yearly_price}/yr`:""]}),e.jsxs(s,{as:"span",variant:"bodySm",tone:"subdued",children:["+",((n.bonus_rate||0)*100).toFixed(1).replace(/\.0$/,""),"% trade-in bonus"]}),n.purchase_cashback_pct?e.jsxs(s,{as:"span",variant:"bodySm",tone:"subdued",children:[n.purchase_cashback_pct,"% cashback"]}):null,n.monthly_credit_amount?e.jsxs(s,{as:"span",variant:"bodySm",tone:"subdued",children:["$",n.monthly_credit_amount,"/mo credit"]}):null,n.benefits?.free_shipping&&e.jsx(P,{tone:"success",children:"Free Shipping"}),n.benefits?.early_access&&e.jsx(P,{children:"Early Access"})]})]})})})}):e.jsx(x,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:e.jsxs(a,{gap:"200",inlineAlign:"center",children:[e.jsx(s,{as:"p",tone:"subdued",children:"No tiers configured yet."}),e.jsx(b,{onClick:()=>de(),icon:We,children:"Create Your First Tier"})]})}),e.jsx(S,{}),e.jsx(s,{as:"h3",variant:"headingSm",children:"Tier Benefits Explained"}),e.jsxs(u,{type:"bullet",children:[e.jsxs(u.Item,{children:[e.jsx("strong",{children:"Trade-In Bonus:"})," Extra percentage added to trade-in value (e.g., +5% on $100 = $5 bonus)"]}),e.jsxs(u.Item,{children:[e.jsx("strong",{children:"Purchase Cashback:"})," Percentage of order total credited back after purchase"]}),e.jsxs(u.Item,{children:[e.jsx("strong",{children:"Monthly Credit:"})," Fixed store credit awarded on the 1st of each month"]}),e.jsxs(u.Item,{children:[e.jsx("strong",{children:"Credit Expiration:"})," How long before issued credits expire (optional)"]})]})]})})}),e.jsx(j.AnnotatedSection,{id:"notifications",title:"Notifications",description:"Email notification settings",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[Le&&e.jsx(T,{tone:"success",onDismiss:()=>ve(""),children:e.jsx("p",{children:Le})}),e.jsx(g,{label:"Enable email notifications",checked:c("notifications","enabled",!0),onChange:n=>d("notifications","enabled",n)}),e.jsx(S,{}),e.jsx(s,{as:"h3",variant:"headingSm",children:"Notification Types"}),e.jsx(g,{label:"Welcome email on enrollment",checked:c("notifications","welcome_email",!0),onChange:n=>d("notifications","welcome_email",n)}),e.jsx(g,{label:"Trade-in status updates",checked:c("notifications","trade_in_updates",!0),onChange:n=>d("notifications","trade_in_updates",n)}),e.jsx(g,{label:"Tier upgrade/downgrade",checked:c("notifications","tier_change",!0),onChange:n=>d("notifications","tier_change",n)}),e.jsx(g,{label:"Store credit issued",checked:c("notifications","credit_issued",!0),onChange:n=>d("notifications","credit_issued",n)}),e.jsx(S,{}),e.jsx(p,{label:"From Name",value:c("notifications","from_name","")||"",onChange:n=>d("notifications","from_name",n),placeholder:"Your Store Name",helpText:"Sender name for emails (defaults to shop name)",autoComplete:"off"}),e.jsx(p,{label:"From Email",type:"email",value:c("notifications","from_email","")||"",onChange:n=>d("notifications","from_email",n),placeholder:"noreply@yourstore.com",helpText:"Sender email (must be verified with SendGrid)",autoComplete:"email"})]})})}),e.jsx(j.AnnotatedSection,{id:"email-templates",title:"Email Templates",description:"Preview and test your email notifications",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"TradeUp sends automatic emails for key events. Preview each template below and send test emails to verify your setup."}),Ke?e.jsxs(r,{align:"center",children:[e.jsx(W,{size:"small"}),e.jsx(s,{as:"span",variant:"bodySm",tone:"subdued",children:"Loading templates..."})]}):Re?.by_category?e.jsx(a,{gap:"500",children:Object.entries(Re.by_category||{}).filter(([n])=>n).map(([n,m])=>e.jsxs(a,{gap:"200",children:[e.jsxs(s,{as:"h4",variant:"headingSm",children:[String(n||"General").replace("_"," ").split(" ").filter(f=>f).map(f=>String(f).charAt(0).toUpperCase()+String(f).slice(1)).join(" ")," Emails"]}),e.jsx(a,{gap:"100",children:m.filter(f=>f&&f.id).map(f=>e.jsx(x,{padding:"300",background:"bg-surface-secondary",borderRadius:"200",children:e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"050",children:[e.jsx(s,{as:"span",variant:"bodyMd",fontWeight:"semibold",children:f.name}),e.jsxs(s,{as:"span",variant:"bodySm",tone:"subdued",children:["Subject: ",(f.subject||"").substring(0,50),"..."]})]}),e.jsxs(r,{gap:"200",children:[e.jsx(b,{icon:pn,variant:"plain",onClick:()=>en(f),loading:_e.isPending&&Z?.id===f.id,children:"Preview"}),e.jsx(b,{icon:mn,variant:"plain",onClick:()=>nn(f),children:"Send Test"})]})]})},f.id))})]},n||"unknown"))}):e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"No email templates available."}),e.jsx(S,{}),e.jsxs(a,{gap:"200",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Email Setup Requirements"}),e.jsxs(u,{type:"bullet",children:[e.jsxs(u.Item,{children:[e.jsx("strong",{children:"SendGrid API Key:"})," Configure in your environment variables"]}),e.jsxs(u.Item,{children:[e.jsx("strong",{children:"Sender Verification:"})," Verify your sending domain with SendGrid"]}),e.jsxs(u.Item,{children:[e.jsx("strong",{children:"From Email:"})," Set above to match your verified domain"]})]})]})]})})}),e.jsx(j.AnnotatedSection,{id:"contact",title:"Support Contact",description:"Contact information shown to customers",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(p,{label:"Support Email",type:"email",value:c("contact","support_email","")||"",onChange:n=>d("contact","support_email",n),placeholder:"support@yourstore.com",autoComplete:"email"}),e.jsx(p,{label:"Support Phone",type:"tel",value:c("contact","support_phone","")||"",onChange:n=>d("contact","support_phone",n),placeholder:"+1 (555) 123-4567",autoComplete:"tel"})]})})}),e.jsx(j.AnnotatedSection,{id:"segments",title:"Shopify Customer Segments",description:"Auto-create segments for tier-based marketing with Shopify Email",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"TradeUp can automatically create customer segments in Shopify based on your membership tiers. Use these segments with Shopify Email to send targeted campaigns to specific member groups."}),e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Sync Tier Segments"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:'Creates "TradeUp Members" (all) + one segment per tier'})]}),e.jsx(b,{onClick:()=>A.mutate(),loading:A.isPending,icon:ge,children:"Sync Segments"})]}),A.isSuccess&&A.data&&e.jsx(T,{tone:"success",onDismiss:()=>A.reset(),children:e.jsxs(a,{gap:"200",children:[e.jsxs(s,{as:"p",variant:"bodySm",children:[A.data.segments.length," segments synced successfully!"]}),e.jsx(u,{type:"bullet",children:A.data.segments.filter(n=>n&&n.id!=null).map(n=>e.jsxs(u.Item,{children:[n.name||"Unknown"," (",n.action||"unknown",")"]},n.id))})]})}),A.isError&&e.jsx(T,{tone:"critical",children:e.jsx("p",{children:"Failed to sync segments. Please try again."})}),e.jsx(S,{}),e.jsxs(a,{gap:"300",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Current TradeUp Segments"}),be?e.jsxs(r,{align:"center",children:[e.jsx(W,{size:"small"}),e.jsx(s,{as:"span",variant:"bodySm",tone:"subdued",children:"Loading segments..."})]}):V?.tradeup_segments&&V.tradeup_segments.length>0?e.jsx(a,{gap:"200",children:V.tradeup_segments.map(n=>e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(r,{gap:"200",children:[e.jsx(P,{tone:"success",children:"Active"}),e.jsx(s,{as:"span",variant:"bodySm",fontWeight:"semibold",children:n.name})]}),e.jsx(s,{as:"span",variant:"bodySm",tone:"subdued",children:n.query})]},n.id))}):e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:'No TradeUp segments found. Click "Sync Segments" to create them.'}),e.jsxs(r,{gap:"200",children:[e.jsx(b,{variant:"plain",onClick:()=>te(),children:"Refresh"}),e.jsx(b,{variant:"plain",url:"https://admin.shopify.com/store/segments",external:!0,children:"View in Shopify →"})]})]}),e.jsx(S,{}),e.jsxs(a,{gap:"200",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"How to Use with Shopify Email"}),e.jsxs(u,{type:"number",children:[e.jsx(u.Item,{children:"Go to Marketing → Campaigns in Shopify Admin"}),e.jsx(u.Item,{children:"Create a new email campaign"}),e.jsx(u.Item,{children:'Under "Recipients", select your TradeUp segment (e.g., "TradeUp Gold Members")'}),e.jsx(u.Item,{children:"Design and send your campaign - only those members will receive it!"})]})]})]})})}),e.jsx(j.AnnotatedSection,{id:"products",title:"Membership Products",description:"Sync tiers as purchasable products in your Shopify store",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Create Shopify products for each membership tier. Customers can purchase these products to join a tier directly through your Shopify checkout."}),e.jsx(x,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Product Setup Wizard"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Guided setup with templates, previews, and customization options"})]}),e.jsx(b,{variant:"primary",onClick:()=>i("/app/products/wizard"),children:"Launch Wizard"})]})}),e.jsx(S,{}),e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Quick Sync (Advanced)"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Automatically creates products with default settings for each tier"})]}),e.jsx(b,{onClick:()=>E.mutate(),loading:E.isPending,icon:ge,children:"Sync Products"})]}),E.isSuccess&&E.data&&e.jsx(T,{tone:"success",onDismiss:()=>E.reset(),children:e.jsxs(a,{gap:"200",children:[e.jsxs(s,{as:"p",variant:"bodySm",children:[E.data.products.length," membership products synced!"]}),e.jsx(u,{type:"bullet",children:E.data.products.filter(n=>n&&n.product_id!=null).map(n=>e.jsxs(u.Item,{children:[n.tier||"Unknown"," Membership (",n.action||"unknown",")"]},n.product_id))})]})}),E.isError&&e.jsx(T,{tone:"critical",children:e.jsx("p",{children:"Failed to sync products. Please try again."})}),e.jsx(S,{}),e.jsxs(a,{gap:"300",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Current Membership Products"}),xe?e.jsxs(r,{align:"center",children:[e.jsx(W,{size:"small"}),e.jsx(s,{as:"span",variant:"bodySm",tone:"subdued",children:"Loading products..."})]}):H?.products&&H.products.length>0?e.jsx(a,{gap:"300",children:H.products.filter(n=>n&&n.id).map(n=>e.jsxs(a,{gap:"100",children:[e.jsx(r,{align:"space-between",blockAlign:"center",children:e.jsxs(r,{gap:"200",children:[e.jsx(P,{tone:n.status==="ACTIVE"?"success":"attention",children:String(n.status||"DRAFT")}),e.jsx(s,{as:"span",variant:"bodySm",fontWeight:"semibold",children:n.title||"Untitled"})]})}),e.jsx(r,{gap:"200",children:(n.variants||[]).filter(m=>m&&m.id).map(m=>e.jsx(P,{tone:"info",children:`${m.title||"Variant"}: $${m.price||"0"}`},m.id))})]},n.id))}):e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:'No membership products found. Click "Sync Products" to create them.'}),e.jsxs(r,{gap:"200",children:[e.jsx(b,{variant:"plain",onClick:()=>ae(),children:"Refresh"}),e.jsx(b,{variant:"plain",url:"https://admin.shopify.com/products",external:!0,children:"View in Shopify →"})]})]}),e.jsx(S,{}),e.jsxs(a,{gap:"200",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"How Membership Purchases Work"}),e.jsxs(u,{type:"number",children:[e.jsx(u.Item,{children:"Customer purchases a membership product in your store"}),e.jsx(u.Item,{children:"TradeUp receives the order webhook and automatically enrolls the customer"}),e.jsx(u.Item,{children:"Customer is tagged with their tier (e.g., tu-gold) and gains benefits"}),e.jsx(u.Item,{children:"For subscriptions, tier continues until subscription is cancelled"})]})]})]})})}),e.jsx(j.AnnotatedSection,{id:"integrations",title:"Partner Integrations",description:"Connect external systems and POS for data sync",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Connect TradeUp with external systems to sync member data, trade-ins, and store credit across platforms."}),e.jsxs(a,{gap:"300",children:[e.jsx(x,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(r,{gap:"300",children:[e.jsx(x,{padding:"200",background:"bg-surface",borderRadius:"100",children:e.jsx(s,{as:"span",variant:"headingMd",children:"POS"})}),e.jsxs(a,{gap:"050",children:[e.jsx(s,{as:"h4",variant:"bodyMd",fontWeight:"semibold",children:"Point of Sale Integration"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Sync members and credit with Shopify POS"})]})]}),e.jsx(P,{tone:"success",children:"Connected"})]})}),e.jsx(x,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(r,{gap:"300",children:[e.jsx(x,{padding:"200",background:"bg-surface",borderRadius:"100",children:e.jsx(s,{as:"span",variant:"headingMd",children:"API"})}),e.jsxs(a,{gap:"050",children:[e.jsx(s,{as:"h4",variant:"bodyMd",fontWeight:"semibold",children:"API Access"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Use the TradeUp API for custom integrations"})]})]}),e.jsx(b,{variant:"secondary",children:"Get API Key"})]})}),e.jsx(x,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(r,{gap:"300",children:[e.jsx(x,{padding:"200",background:"bg-surface",borderRadius:"100",children:e.jsx(s,{as:"span",variant:"headingMd",children:"ERP"})}),e.jsxs(a,{gap:"050",children:[e.jsx(s,{as:"h4",variant:"bodyMd",fontWeight:"semibold",children:"ERP/Accounting System"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Export transaction data for accounting"})]})]}),e.jsx(P,{children:"Coming Soon"})]})}),e.jsx(x,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(r,{gap:"300",children:[e.jsx(x,{padding:"200",background:"bg-surface",borderRadius:"100",children:e.jsx(s,{as:"span",variant:"headingMd",children:"CRM"})}),e.jsxs(a,{gap:"050",children:[e.jsx(s,{as:"h4",variant:"bodyMd",fontWeight:"semibold",children:"CRM Integration"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Sync member data with your CRM"})]})]}),e.jsx(P,{children:"Coming Soon"})]})})]}),e.jsx(S,{}),e.jsxs(a,{gap:"200",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Webhook Endpoints"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Receive real-time notifications when events occur in TradeUp."}),e.jsxs(u,{type:"bullet",children:[e.jsx(u.Item,{children:"member.created - New member enrolled"}),e.jsx(u.Item,{children:"member.tier_changed - Member tier upgraded/downgraded"}),e.jsx(u.Item,{children:"trade_in.submitted - New trade-in received"}),e.jsx(u.Item,{children:"trade_in.approved - Trade-in approved, credit issued"}),e.jsx(u.Item,{children:"credit.issued - Store credit added to member"})]}),e.jsx(b,{variant:"plain",url:"https://docs.tradeup.io/webhooks",external:!0,children:"View Webhook Documentation →"})]})]})})}),e.jsx(j.AnnotatedSection,{id:"scheduled-tasks",title:"Monthly Credits & Automation",description:"Manage automated credit distribution and expiration",children:e.jsxs(a,{gap:"400",children:[Ae&&e.jsx(T,{tone:"success",onDismiss:()=>N(""),children:e.jsx("p",{children:Ae})}),Ee&&e.jsx(T,{tone:"critical",onDismiss:()=>X(""),children:e.jsx("p",{children:Ee})}),e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsxs(r,{gap:"200",blockAlign:"center",children:[e.jsx(Ce,{source:gn,tone:"base"}),e.jsx(s,{as:"h3",variant:"headingMd",children:"Monthly Credit Distribution"})]}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Automatically issues store credit to members based on their tier benefits on the 1st of each month."})]}),e.jsx(r,{gap:"200",children:e.jsx(b,{onClick:()=>Ge(),loading:Pe,icon:ge,children:"Refresh"})})]}),e.jsx(S,{}),Pe?e.jsxs(r,{align:"center",children:[e.jsx(W,{size:"small"}),e.jsx(s,{as:"span",variant:"bodySm",children:"Loading preview..."})]}):q?e.jsxs(a,{gap:"300",children:[e.jsxs(r,{gap:"400",wrap:!0,children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Eligible Members"}),e.jsx(s,{as:"p",variant:"headingLg",children:q.credited})]}),e.jsxs(a,{gap:"100",children:[e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Total Amount"}),e.jsxs(s,{as:"p",variant:"headingLg",children:["$",(q.total_amount||0).toFixed(2)]})]}),e.jsxs(a,{gap:"100",children:[e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Already Received"}),e.jsx(s,{as:"p",variant:"headingLg",children:q.skipped})]})]}),q.credited>0&&e.jsx(x,{paddingBlockStart:"200",children:e.jsxs(a,{gap:"200",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Preview (first 5 members):"}),q.details.slice(0,5).filter(n=>n&&n.member_number).map((n,m)=>e.jsxs(r,{gap:"200",align:"space-between",children:[e.jsxs(s,{as:"span",variant:"bodySm",children:[n.member_number||"Unknown"," (",n.tier||"No tier",")"]}),e.jsx(P,{tone:"success",children:`$${(n.amount||0).toFixed(2)}`})]},m))]})}),e.jsx(x,{paddingBlockStart:"200",children:e.jsxs(r,{gap:"200",children:[e.jsx(b,{variant:"primary",onClick:()=>Me.mutate(),loading:Me.isPending,disabled:q.credited===0,children:"Distribute Credits Now"}),q.credited===0&&e.jsx(s,{as:"span",variant:"bodySm",tone:"subdued",children:"All eligible members have already received credits this month"})]})})]}):e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"No members with tier monthly credits configured"})]})}),e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsxs(r,{gap:"200",blockAlign:"center",children:[e.jsx(Ce,{source:bn,tone:"base"}),e.jsx(s,{as:"h3",variant:"headingMd",children:"Credit Expiration"})]}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Credits with expiration dates are automatically expired. View upcoming expirations and process expired credits."})]}),e.jsx(r,{gap:"200",children:e.jsx(b,{onClick:()=>ze(),loading:Fe,icon:ge,children:"Refresh"})})]}),e.jsx(S,{}),Fe?e.jsxs(r,{align:"center",children:[e.jsx(W,{size:"small"}),e.jsx(s,{as:"span",variant:"bodySm",children:"Loading..."})]}):Q?e.jsxs(a,{gap:"300",children:[e.jsxs(r,{gap:"400",wrap:!0,children:[e.jsxs(a,{gap:"100",children:[e.jsxs(s,{as:"p",variant:"bodySm",tone:"subdued",children:["Expiring in ",Q.days_ahead," days"]}),e.jsxs(s,{as:"p",variant:"headingLg",children:[Q.members_with_expiring_credits," members"]})]}),e.jsxs(a,{gap:"100",children:[e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Total Amount Expiring"}),e.jsxs(s,{as:"p",variant:"headingLg",children:["$",(Q.total_amount_expiring||0).toFixed(2)]})]})]}),Q.members.length>0&&e.jsx(x,{paddingBlockStart:"200",children:e.jsxs(a,{gap:"200",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Members with expiring credits:"}),Q.members.slice(0,5).filter(n=>n&&n.member_number).map((n,m)=>e.jsxs(r,{gap:"200",align:"space-between",children:[e.jsxs(s,{as:"span",variant:"bodySm",children:[n.member_number||"Unknown"," (",n.email||"No email",")"]}),e.jsx(P,{tone:"warning",children:`$${(n.total_expiring||0).toFixed(2)}`})]},m))]})}),e.jsx(x,{paddingBlockStart:"200",children:e.jsx(b,{onClick:()=>Ie.mutate(),loading:Ie.isPending,children:"Process Expired Credits"})})]}):e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"No credits with expiration dates"})]})}),e.jsx(y,{children:e.jsxs(a,{gap:"200",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Automation Schedule"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"These tasks run automatically on a schedule:"}),e.jsxs(u,{children:[e.jsxs(u.Item,{children:[e.jsx(s,{as:"span",fontWeight:"semibold",children:"Monthly credits:"})," 1st of each month at 6:00 AM UTC"]}),e.jsxs(u.Item,{children:[e.jsx(s,{as:"span",fontWeight:"semibold",children:"Credit expiration:"})," Daily at midnight UTC"]}),e.jsxs(u.Item,{children:[e.jsx(s,{as:"span",fontWeight:"semibold",children:"Expiration warnings:"})," Daily at 9:00 AM UTC (7-day warning)"]})]})]})})]})}),e.jsx(j.AnnotatedSection,{id:"support",title:"Support & Feedback",description:"Get help or submit feedback about TradeUp",children:e.jsx(y,{children:e.jsxs(a,{gap:"400",children:[e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsxs(r,{gap:"200",blockAlign:"center",children:[e.jsx(Ce,{source:xn,tone:"base"}),e.jsx(s,{as:"h3",variant:"headingSm",children:"Report an Issue or Request a Feature"})]}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Let us know if you encounter any issues or have ideas for improvements."})]}),e.jsx(b,{onClick:()=>Ne(!0),children:"Submit Feedback"})]}),e.jsx(S,{}),e.jsxs(a,{gap:"200",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Contact Support"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Need help? Reach out to our support team."}),e.jsxs(r,{gap:"200",children:[e.jsx(b,{variant:"plain",url:"mailto:mike@orbsportscards.com",external:!0,children:"Email Support"}),e.jsx(b,{variant:"plain",url:"https://docs.tradeup.io",external:!0,children:"Documentation"})]})]})]})})}),e.jsx(j.AnnotatedSection,{id:"danger",title:"Danger Zone",description:"Irreversible actions",children:e.jsx(y,{children:e.jsx(a,{gap:"400",children:e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{as:"h3",variant:"headingSm",children:"Reset Program Data"}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"This will delete all members and trade-in history. This action cannot be undone."})]}),e.jsx(b,{variant:"primary",tone:"critical",disabled:!0,children:"Reset Data"})]})})})})]}),e.jsx(I,{open:ie,onClose:ue,title:F?`Edit ${F.name} Tier`:"Create New Tier",primaryAction:{content:F?"Save Changes":"Create Tier",onAction:sn,loading:ye.isPending||fe.isPending},secondaryActions:[{content:"Cancel",onAction:ue}],children:e.jsxs(I.Section,{children:[ce&&e.jsx(x,{paddingBlockEnd:"400",children:e.jsx(T,{tone:"critical",onDismiss:()=>U(""),children:e.jsx("p",{children:ce})})}),e.jsxs(ke,{children:[e.jsx(p,{label:"Tier Name",value:o.name,onChange:n=>C({...o,name:n}),placeholder:"Gold, Platinum, VIP, etc.",autoComplete:"off",requiredIndicator:!0}),e.jsxs(ke.Group,{children:[e.jsx(p,{label:"Monthly Price",type:"number",value:o.monthly_price,onChange:n=>C({...o,monthly_price:n}),prefix:"$",suffix:"/mo",autoComplete:"off",helpText:"Set to 0 for free tier"}),e.jsx(p,{label:"Yearly Price",type:"number",value:o.yearly_price,onChange:n=>C({...o,yearly_price:n}),prefix:"$",suffix:"/yr",autoComplete:"off",helpText:"Optional discount for annual"})]}),e.jsx(S,{}),e.jsx(s,{as:"h3",variant:"headingSm",children:"Tier Benefits"}),e.jsx(p,{label:"Trade-In Bonus",type:"number",value:o.bonus_rate,onChange:n=>C({...o,bonus_rate:n}),suffix:"%",autoComplete:"off",helpText:"Extra percentage added to trade-in value. E.g., 5% bonus on $100 trade = $5 extra credit."}),e.jsx(p,{label:"Purchase Cashback",type:"number",value:o.purchase_cashback_pct,onChange:n=>C({...o,purchase_cashback_pct:n}),suffix:"%",autoComplete:"off",helpText:"Percentage of purchase total credited back"}),e.jsx(p,{label:"Monthly Credit",type:"number",value:o.monthly_credit,onChange:n=>C({...o,monthly_credit:n}),prefix:"$",suffix:"/month",autoComplete:"off",helpText:"Fixed store credit awarded on 1st of each month"}),e.jsx(G,{label:"Credit Expiration",options:En,value:o.credit_expiration_days,onChange:n=>C({...o,credit_expiration_days:n}),helpText:"How long before awarded credits expire"}),e.jsx(p,{label:"Store Discount",type:"number",value:o.discount_percent,onChange:n=>C({...o,discount_percent:n}),suffix:"%",autoComplete:"off",helpText:"Discount applied to all purchases (optional)"}),e.jsx(p,{label:"Signup Bonus",type:"number",value:o.signup_bonus,onChange:n=>C({...o,signup_bonus:n}),prefix:"$",autoComplete:"off",helpText:"One-time store credit bonus when member joins this tier"}),e.jsx(S,{}),e.jsx(s,{as:"h3",variant:"headingSm",children:"Feature Benefits"}),e.jsx(g,{label:"Free Shipping",checked:o.free_shipping,onChange:n=>C({...o,free_shipping:n}),helpText:"Members get free shipping on all orders"}),e.jsx(g,{label:"Early Access",checked:o.early_access,onChange:n=>C({...o,early_access:n}),helpText:"Early access to new product releases"}),e.jsx(g,{label:"Exclusive Events",checked:o.exclusive_events,onChange:n=>C({...o,exclusive_events:n}),helpText:"Access to member-only events and sales"}),e.jsx(g,{label:"Priority Support",checked:o.priority_support,onChange:n=>C({...o,priority_support:n}),helpText:"Priority customer support queue"})]})]})}),e.jsx(I,{open:Ve,onClose:()=>Se(!1),title:`Preview: ${Z?.name||"Email Template"}`,size:"large",secondaryActions:[{content:"Close",onAction:()=>Se(!1)}],children:e.jsx(I.Section,{children:e.jsxs(a,{gap:"400",children:[e.jsx(x,{padding:"300",background:"bg-surface-secondary",borderRadius:"200",children:e.jsxs(r,{gap:"200",children:[e.jsx(s,{as:"span",variant:"bodySm",fontWeight:"semibold",children:"Subject:"}),e.jsx(s,{as:"span",variant:"bodySm",children:Je})]})}),e.jsx(x,{padding:"400",background:"bg-surface",borderRadius:"200",borderWidth:"025",borderColor:"border",children:e.jsx("div",{dangerouslySetInnerHTML:{__html:Qe},style:{fontFamily:"-apple-system, BlinkMacSystemFont, sans-serif"}})}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"This is a preview with sample data. Actual emails will include real member information."})]})})}),e.jsx(I,{open:He,onClose:()=>{he(!1),Y("")},title:`Send Test: ${Z?.name||"Email"}`,primaryAction:{content:"Send Test Email",onAction:()=>Be.mutate(),loading:Be.isPending,disabled:!pe},secondaryActions:[{content:"Cancel",onAction:()=>{he(!1),Y("")}}],children:e.jsx(I.Section,{children:e.jsxs(a,{gap:"400",children:[Oe&&e.jsx(T,{tone:"critical",onDismiss:()=>Y(""),children:e.jsx("p",{children:Oe})}),e.jsx(s,{as:"p",variant:"bodySm",tone:"subdued",children:"Send a test email to verify your email configuration is working correctly."}),e.jsx(p,{label:"Recipient Email",type:"email",value:pe,onChange:De,placeholder:"you@example.com",autoComplete:"email",requiredIndicator:!0}),e.jsx(p,{label:"Recipient Name",value:Ue,onChange:qe,placeholder:"John Doe",autoComplete:"name",helpText:"Name used in the email greeting"})]})})}),e.jsx(I,{open:oe!==null,onClose:()=>le(null),title:"Delete tier?",primaryAction:{content:"Delete",destructive:!0,onAction:()=>{oe&&(Te.mutate(oe.id),le(null))},loading:Te.isPending},secondaryActions:[{content:"Cancel",onAction:()=>le(null)}],children:e.jsx(I.Section,{children:e.jsxs(s,{as:"p",children:['Are you sure you want to delete the "',oe?.name,'" tier? This action cannot be undone.']})})}),e.jsxs(yn,{id:"settings-save-bar",children:[e.jsx("button",{variant:"primary",onClick:tn,disabled:me.isPending,children:me.isPending?"Saving...":"Save"}),e.jsx("button",{onClick:an,children:"Discard"})]}),e.jsx(vn,{open:Ze,onClose:()=>Ne(!1)})]}):e.jsx(we,{title:"Settings",children:e.jsx(T,{tone:"warning",children:e.jsx("p",{children:"No shop connected. Please install the app from the Shopify App Store."})})})}export{Qn as EmbeddedSettings};
